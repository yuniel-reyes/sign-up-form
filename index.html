<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>

</head>
<body>
    <section class="banner-one">
    </section>
    <main id="main-container">
        <form id="my-form">
            <div class="all-inputs-containers">
                <ul class="container-one">
                    <li><label for="fname">First Name*</label><input type="text" id="fname" name="fname" required autocomplete="off"></li>
                    <li><label for="email">Email*</label><input type="email" id="usermail" name="usermail" required autocomplete="off"></li>
                    <li><label for="pwd">Password*</label><input type="password" id="pwd" name="pwd" required autocomplete="off" title="Password must contain at 
least 8 characters: uppercase, 
lowercase, number and other characters. 
Valid password example: Z-2.we?{"></li>
                </ul>
                <ul class="container-two">
                    <li><label for="lname">Last Name*</label><input type="text" id="lname" name="lname" required autocomplete="off"></li>
                    <li><label for="pnumber">Phone Number*</label><input type="tel" id="pnumber" name="pnumber" required pattern="[0-9]{9}" title="Only numbers are valid" autocomplete="off"></li>
                    <li><label for="twice-pwd">Confirm Password*</label><input type="password" id="twice-pwd" name="twice-pwd" required title="Passwords must match"></li>
                </ul>
            </div>
            <div class="new-account-btn-container password-msg">
                <button id="new-account-btn" type="submit" form="my-form">Create Account</button>
                <p class="error-msg"></p>
            </div>    
        </form>
        <div class="change-to-login">
            <p>Already have and account? <a href="#">Log in</a></p>
        </div>
    </main>
    <div class="banner-two">
        <div id="logos-container">
                <div class="odin-container"><a href="https://www.theodinproject.com/" target="_blank"><img id="odin-logo" src="images/odin-lined.png" alt="odin-logo"></a></div>
                <div class="odin-tag"><p class="odin">odin</p></div>
                <div class="github-container"><a href="" target="_blank"><img id="github-logo" src="images/GitHub-Mark-32px.png" alt="github-logo"></img></a></div>    
        </div>            
        <a href='https://www.freepik.com/photos/man-thinking'>"Man thinking". Photo created by wayhomestudio - www.freepik.com</a></div>
        <script>


            // Create confirmPassword()
            function confirmPassword(e){
                if (firstPassword !== e.target.value){
                    errorMessage.textContent = "Passwords must match"
                    e.target.pattern = "";
                    return;
                } else {
                    errorMessage.textContent = "";
                    e.target.pattern = e.target.value;
                    return;
                }
            }


            // Create checkPassword()
            function checkPassword(e) {

                if (validFirst && e.target.id == "twice-pwd"){
                    confirmPassword(e);
                    return;
                }
                
                const UPPER_CASES = /[A-Z]/;
                const LOWER_CASES = /[a-z]/;
                const NUMBERS = /[0-9]/;
                const OTHER_CHARS = /\W/;
                let passWord = e.target.value;

                if ((passWord.length == 0) || (!UPPER_CASES.test(passWord)) || (!NUMBERS.test(passWord)) ||
                    (!LOWER_CASES.test(passWord)) || (passWord.length < 8) || (!OTHER_CHARS.test(passWord))) {
                        errorMessage.textContent = "Enter valid password";
                        e.target.pattern = "";
                        // validFirst = false;
                        firstPassword = passWord;
                        return;
                } else {
                    errorMessage.textContent = "";
                    e.target.pattern = passWord;
                    validFirst = true;
                    firstPassword = passWord;
                    return;
                }

            }
                        
            // REFERENCES for first password
            // Get reference of first password node
            const pwdOne = document.querySelector('input[id=pwd]');
            // Check passwords
            pwdOne.oninput = (e) => checkPassword(e);
            // Check password on focus
            pwdOne.onfocus = checkPassword;
            // Remove error message if focus out            
            pwdOne.addEventListener('focusout', (e) => {
               errorMessage.textContent = "";
            });

            // REFERENCES for second password
            // Get reference of password confirmation node
            const twicePwd = document.querySelector('input[id=twice-pwd]');
            // Check passwords
            twicePwd.oninput = (e) => checkPassword(e)
            // Check password on focus
            twicePwd.onfocus = checkPassword;            
            // Remove error msg when focus out of password
            twicePwd.addEventListener('focusout', (e) => {
               errorMessage.textContent = "";
            });

            // Get reference to error message node
            const errorMessage = document.querySelector('.error-msg');
            // Store first entered password
            let firstPassword = "";
            let validFirst = Boolean();

        </script>
</body>
</html>